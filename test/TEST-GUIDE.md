# 区块链测试指南

本文档提供了如何测试区块链功能的步骤说明。

## 准备工作

1. 确保已安装所有依赖：
   ```bash
   npm install
   ```

2. 在一个终端窗口启动区块链节点：
   ```bash
   npm start
   ```

3. 在另一个终端窗口运行测试脚本：
   ```bash
   npm test
   ```

## 测试流程

测试脚本提供了一个交互式菜单，可以测试以下功能：

### 1. 运行基本测试流程

这个选项会自动执行以下步骤：
- 创建两个测试钱包（如果尚未创建）
- 挖矿获取代币
- 查询钱包余额
- 创建转账交易
- 提交交易到区块链
- 再次挖矿确认交易
- 检查两个钱包的最终余额
- 查看区块链状态

### 2. 创建新钱包

手动创建一个新钱包，需要提供：
- 钱包名称
- 钱包密码

成功后会显示钱包地址和助记词。

### 3. 挖矿

手动挖矿，需要提供：
- 矿工地址（挖矿奖励接收地址）

### 4. 查询余额

查询指定地址的余额，需要提供：
- 查询地址

### 5. 创建并提交交易

手动创建和提交交易，需要提供：
- 发送方钱包名称
- 钱包密码
- 接收方地址
- 转账金额

### 6. 查看区块链状态

查看当前区块链的基本信息：
- 区块数量
- 待处理交易数量

## 常见问题解决

1. **钱包加载失败**：
   - 确保输入了正确的钱包名称和密码
   - 检查钱包文件是否存在于wallets目录中

2. **交易失败**：
   - 检查发送方余额是否足够
   - 确保已挖矿获取了足够的代币

3. **API连接失败**：
   - 确保区块链节点正在运行（npm start）
   - 默认端口是3000，确保没有被其他程序占用

4. **"data is not iterable"错误已修复**：
   - 如果仍然出现此错误，请确保使用的是最新版本的代码

## 测试状态保存

测试脚本会将钱包信息和交易记录保存在`test-state.json`文件中，这样在下次运行测试时可以继续使用相同的钱包而不需要重新创建。

如果需要重新开始测试，只需删除`test-state.json`文件和`wallets`目录中的钱包文件。
